(function(){angular.module("okiGreenApp",["ngRoute","ngSanitize","ui.bootstrap","n3-pie-chart","n3-line-chart","btford.socket-io"]);function e(e,t){e.when("/home",{templateUrl:"/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/about",{templateUrl:"/common/views/genericText.view.html",controller:"aboutCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});t.html5Mode(true)}angular.module("okiGreenApp").config(["$routeProvider","$locationProvider",e])})();(function(){angular.module("okiGreenApp").controller("homeCtrl",e);e.$inject=["$routeParams","okiGreenData","$modal","$location","authentication","mySocket"];function e(e,t,a,n,r,i){var l=this;l.pageHeader={title:"OKiGreen",strapline:"Its time to grow your own food!"};l.sidebar={content:"Its time to grow, OKiGreen will help you grow kitchen vegetables at the comfort of your home with very minimal supervision."};l.locationid=e.locationid;l.isLoggedIn=r.isLoggedIn();l.currentPath=n.path();l.popupSettingForm=function(){var e=a.open({templateUrl:"/settingModal/settingModal.view.html",controller:"settingModalCtrl as vm",resolve:{locationData:function(){return{locationid:l.locationid}}}})};i.on("Temperature reading",function(e){l.temp=e.temp;console.log(l.temp);l.temppieoptions={thickness:15,mode:"gauge",total:100};l.temppiedata=[{label:"Temperature",value:l.temp,color:"#ff3300",suffix:" DegC"}]});i.on("Humidity reading",function(e){l.humid=e.humid;console.log(l.humid);l.humidpieoptions={thickness:15,mode:"gauge",total:100};l.humidpiedata=[{label:"Humidity",value:l.humid,color:"#ff9933",suffix:"%"}]});i.on("Water reading",function(e){l.water=e.water;console.log(l.water);l.wabapieoptions={thickness:15,mode:"gauge",total:100};l.wabapiedata=[{label:"Water Saturation",value:l.water,color:"#3366ff",suffix:"%"}]});l.wabalinedata={dataset0:[{x:0,val_0:0,val_1:0,val_2:0,val_3:0},{x:1,val_0:.993,val_1:3.894,val_2:8.47,val_3:14.347},{x:2,val_0:1.947,val_1:7.174,val_2:13.981,val_3:19.991},{x:3,val_0:2.823,val_1:9.32,val_2:14.608,val_3:13.509},{x:4,val_0:3.587,val_1:9.996,val_2:10.132,val_3:-1.167},{x:5,val_0:4.207,val_1:9.093,val_2:2.117,val_3:-15.136},{x:6,val_0:4.66,val_1:6.755,val_2:-6.638,val_3:-19.923},{x:7,val_0:4.66,val_1:6.755,val_2:-6.638,val_3:-19.923},{x:8,val_0:4.66,val_1:6.755,val_2:-6.638,val_3:-19.923},{x:9,val_0:4.927,val_1:3.35,val_2:-13.074,val_3:-12.625}]};l.wabalineoptions={series:[{axis:"y",dataset:"dataset0",key:"val_0",label:"OKiGreen water consumption analysis",color:"#3366ff",type:["line","dot","area"],id:"mySeries0"}],axes:{x:{key:"x"}}};l.templinedata={dataset0:[{x:0,val_0:0,val_1:0,val_2:0,val_3:0},{x:1,val_0:.993,val_1:3.894,val_2:8.47,val_3:14.347},{x:2,val_0:1.947,val_1:7.174,val_2:13.981,val_3:19.991},{x:3,val_0:2.823,val_1:9.32,val_2:14.608,val_3:13.509},{x:4,val_0:3.587,val_1:9.996,val_2:10.132,val_3:-1.167},{x:5,val_0:4.207,val_1:9.093,val_2:2.117,val_3:-15.136},{x:6,val_0:4.66,val_1:6.755,val_2:-6.638,val_3:-19.923},{x:7,val_0:4.66,val_1:6.755,val_2:-6.638,val_3:-19.923},{x:8,val_0:4.66,val_1:6.755,val_2:-6.638,val_3:-19.923},{x:9,val_0:4.927,val_1:3.35,val_2:-13.074,val_3:-12.625}]};l.templineoptions={series:[{axis:"y",dataset:"dataset0",key:"val_0",label:"OKiGreen temperature analysis",color:"#ff3300",type:["line","dot","area"],id:"mySeries0"},{axis:"y2",dataset:"dataset0",key:"val_1",label:"",color:"#ff3300",type:["line","dot","area"],id:"mySeries1"}],axes:{x:{key:"x"}}};l.humidlinedata={dataset0:[{x:0,val_0:0,val_1:0,val_2:0,val_3:0},{x:1,val_0:.993,val_1:3.894,val_2:8.47,val_3:14.347},{x:2,val_0:1.947,val_1:7.174,val_2:13.981,val_3:19.991},{x:3,val_0:2.823,val_1:9.32,val_2:14.608,val_3:13.509},{x:4,val_0:3.587,val_1:9.996,val_2:10.132,val_3:-1.167},{x:5,val_0:4.207,val_1:9.093,val_2:2.117,val_3:-15.136},{x:6,val_0:4.66,val_1:6.755,val_2:-6.638,val_3:-19.923},{x:7,val_0:4.66,val_1:6.755,val_2:-6.638,val_3:-19.923},{x:8,val_0:4.66,val_1:6.755,val_2:-6.638,val_3:-19.923},{x:9,val_0:4.927,val_1:3.35,val_2:-13.074,val_3:-12.625}]};l.humidlineoptions={series:[{axis:"y",dataset:"dataset0",key:"val_0",label:"OKiGreen humdity analysis",color:"#ff9933",type:["line","dot","area"],id:"mySeries0"}],axes:{x:{key:"x"}}}}})();(function(){angular.module("okiGreenApp").controller("aboutCtrl",e);function e(){var e=this;e.pageHeader={title:"About OKiGreen"};e.main={content:"OKiGreen was created to take control of their kitchen gardening by growing vegetables, with minimal control and supervision.\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc sed lorem ac nisi dignissim accumsan. Nullam sit amet interdum magna. Morbi quis faucibus nisi. Vestibulum mollis purus quis eros adipiscing tristique. Proin posuere semper tellus, id placerat augue dapibus ornare. Aenean leo metus, tempus in nisl eget, accumsan interdum dui. Pellentesque sollicitudin volutpat ullamcorper.\n\nSuspendisse tincidunt, lectus non suscipit pharetra, purus ipsum vehicula sapien, a volutpat mauris ligula vel dui. Proin varius interdum elit, eu porttitor quam consequat et. Quisque vitae felis sed ante fringilla fermentum in vitae sem. Quisque fermentum metus at neque sagittis imperdiet. Phasellus non laoreet massa, eu laoreet nibh. Pellentesque vel magna vulputate, porta augue vel, dapibus nisl. Phasellus aliquet nibh nec nunc posuere fringilla. Quisque sit amet dignissim erat. Nulla facilisi. Donec in sollicitudin ante. Cras rhoncus accumsan rutrum. Sed aliquet ligula dui, eget laoreet turpis tempor vitae."}}})();(function(){angular.module("okiGreenApp").controller("loginCtrl",e);e.$inject=["$location","authentication"];function e(e,t){var a=this;a.pageHeader={title:"login to OKiGreen"};a.credentials={email:"",password:""};a.returnPage=e.search().page||"/home";a.onSubmit=function(){a.formError="";if(!a.credentials.email||!a.credentials.password){a.formError="All fields required, please try again";return false}else{a.doLogin()}};a.doLogin=function(){a.formError="";t.login(a.credentials).error(function(e){a.formError=e}).then(function(){e.search("page",null);e.path(a.returnPage)})}}})();(function(){angular.module("okiGreenApp").controller("registerCtrl",e);e.$inject=["$location","authentication"];function e(e,t){var a=this;a.pageHeader={title:"Create a new OKiGreen account"};a.credentials={name:"",email:"",password:""};a.returnPage=e.search().page||"/home";a.onSubmit=function(){a.formError="";if(!a.credentials.name||!a.credentials.email||!a.credentials.password){a.formError="All fields required, please try again";return false}else{a.doRegister()}};a.doRegister=function(){a.formError="";t.register(a.credentials).error(function(e){a.formError=e}).then(function(){e.search("page",null);e.path(a.returnPage)})}}})();(function(){angular.module("okiGreenApp").directive("barsView",e);function e(){return{restrict:"E",scope:{data:"="},link:e};function e(e,t,a){var n=e.$parent.items;var r=a.width,i=a.height;var l=d3.select($element[0]).append("svg");l.attr({width:r,height:i});var o=d3.max(n,function(e){return e.Value});var u=d3.scale.category20();var s=30;var c=15;var v=22;l.selectAll("rect").data(n).enter().append("rect").attr({height:s,width:0,x:0,y:function(e,t){return t*s},stroke:"white"}).style("fill",function(e,t){return u(t)}).transition().duration(1e3).attr("width",function(e){return e.Value/(o/r)});l.selectAll("rect").data(n).transition().duration(1e3).attr("width",function(e,t){return e.Value/(o/r)});l.selectAll("text").data(n).enter().append("text").attr({fill:"#fff",x:c,y:function(e,t){return t*s+v}}).text(function(e){return e.Name+" ("+e.Value+")"});l.selectAll("text").data(n).attr({fill:"#fff",x:c,y:function(e,t){return t*s+v}}).text(function(e){return e.Name+" ("+e.Value+")"})}}})();(function(){angular.module("okiGreenApp").controller("settingModalCtrl",e);e.$inject=["$modalInstance","locationData","okiGreenData"];function e(e,t,a){var n=this;n.modal={cancel:function(){e.dismiss("cancel")},close:function(t){e.close(t)}}}})();(function(){angular.module("okiGreenApp").service("authentication",e);e.$inject=["$http","$window"];function e(e,t){var a=function(e){t.localStorage["okiGreen-token"]=e};var n=function(){return t.localStorage["okiGreen-token"]};var r=function(){var e=n();if(e){var a=JSON.parse(t.atob(e.split(".")[1]));return a.exp>Date.now()/1e3}else{return false}};var i=function(){if(r()){var e=n();var a=JSON.parse(t.atob(e.split(".")[1]));return{email:a.email,name:a.name}}};register=function(t){return e.post("/api/register",t).success(function(e){a(e.token)})};login=function(t){return e.post("/api/login",t).success(function(e){a(e.token)})};logout=function(){t.localStorage.removeItem("okiGreen-token")};return{currentUser:i,saveToken:a,getToken:n,isLoggedIn:r,register:register,login:login,logout:logout}}})();(function(){angular.module("okiGreenApp").service("okiGreenData",e);e.$inject=["$http","authentication"];function e(e,t){var a;var n;return{okiGreenSensorData:a,okiGreenSetting:n}}})();(function(){angular.module("okiGreenApp").factory("mySocket",e);e.$inject=["socketFactory"];function e(e){return e()}})();(function(){angular.module("okiGreenApp").filter("addHtmlLineBreaks",e);function e(){return function(e){var t=e.replace(/\n/g,"<br/>");return t}}})();(function(){angular.module("okiGreenApp").controller("navigationCtrl",e);e.$inject=["$location","authentication"];function e(e,t){var a=this;a.currentPath=e.path();a.isLoggedIn=t.isLoggedIn();a.currentUser=t.currentUser();a.logout=function(){t.logout();e.path("/")}}})();(function(){angular.module("okiGreenApp").directive("navigation",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html",controller:"navigationCtrl as navvm"}}})();(function(){angular.module("okiGreenApp").directive("footerGeneric",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();(function(){angular.module("okiGreenApp").directive("pageHeader",e);function e(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}})();(function(){angular.module("okiGreenApp").directive("ratingStars",e);function e(){return{restrict:"EA",scope:{thisRating:"=rating"},templateUrl:"/common/directives/ratingStars/ratingStars.template.html"}}})();